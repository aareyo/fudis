import { ArgTypes, Meta, Canvas } from "@storybook/blocks";
import { linkTo } from "@storybook/addon-links";
import { ExpandableComponent } from "./expandable.component";
import * as ExpandableStories from "./expandable.stories.ts";

<Meta title="Components/Expandable" />

# Expandable

Fudis Expandable has two visual types: `variant: “regular”` and `variant: “lite”`, from which the latter is a lighter, link looking version of the component.

Expandable is closed initially by default; this can be controlled with the `closed` input property.

Expandable's content and additional header buttons are provided via content projection by using `fudisContent` and `fudisAction` directives:

```
<fudis-expandable>
  <ng-template fudisActions type="expandable">
    <fudis-button/>
  </ng-template>

  <ng-template fudisContent type="expandable">
    <your-body-template/>
  </ng-template>
</fudis-expandable>
```

All buttons wrapped in the fudisActions ng-template will appear to the right side of the header bar and on sm-sized screen they move to their own level.

The content of the expandable is only initialized when the expandable is expanded for the first time. This helps to avoid unnecessary requests to the backend (among other expensive operations). Subsequent closing/expanding only hides the content instead of removing it from the DOM, for the same reason.

About using lazy initalisation with content projection, see [Angular example of conditional content projection](https://angular.io/guide/content-projection#conditional-content-projection) for more background.

## Examples

<Canvas of={ExpandableStories.AllVariants}></Canvas>

### Expandable and Fudis Form Error Summary

Input `errorSummaryBreadcrumb` is a boolean that determines whether the expandable title is shown in the breadcrumb of Form Error Summary. This can be useful if Form structure is nested where there is a validatable forms in the contents of the expandable.

Note: If there is Fudis Form components, such as Fudis Text Input, as expandable's content, the expandable must be first opened (and loaded to the DOM) before Error Summary gets information about invalid Form components.

### Accessibility

- Expandable Regular heading background and text color contrast ratio meets AA and AAA levels.
- Expandable Lite heading uses primary-color variable (`--fudis-color-primary`) which is set in the root of the application. Make sure the application's primary-color contrast ratio meets WCAG AA and AAA levels.
- Expandable title is a required property.
- Expandable header buttons and the expandable content are semantically correct and accessible by screen readers.
- Information about the expandable's closed state is conveyed to screen readers.
- Header expanding block and the additional buttons have a visible focus state
- Header expanding block and the additional buttons' click can be triggered with keyboard <code>enter</code> and <code>space</code> key
- Support for semantic header aria-level for screen reader users. The expandable semantic level is set to equal `h2` as a default and can be changed via the level input: `level: 2` equals to `h2`, `level: 3` equals to `h3` etc. Changing the level does not affect to the appearance of the component.

### Related components

[Icon](/docs/components-icon--icon)

[Button](/docs/components-button--button)

## Properties

<ArgTypes of={ExpandableComponent} />
