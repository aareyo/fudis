<div class="fudis-autocomplete fudis-autocomplete__{{ size }}">
	<fudis-label
		[text]="label"
		[id]="_id + '__label'"
		[for]="_id"
		[requiredText]="requiredText"
		[tooltip]="tooltip"
		[tooltipPosition]="tooltipPosition"
		[tooltipToggle]="tooltipToggle">
	</fudis-label>
	<div class="fudis-autocomplete__input-wrapper">
		<input
			[attr.aria-invalid]="(control.touched && control.invalid) || (control.touched && invalidState) ? true : null"
			#fudisAutocompleteInput
			class="fudis-autocomplete__input"
			[id]="_id"
			[class.fudis-autocomplete__input--invalid]="(control.invalid && control.touched) || invalidState"
			[class.fudis-autocomplete__input--disabled]="disabled"
			type="text"
			(blur)="autocompleteBlur($event)"
			[formControl]="autocompleteFormControl"
			[matAutocomplete]="autocomplete"
			[attr.aria-describedby]="_id + '_guidance'"
			[readonly]="disabled"
			[attr.aria-disabled]="disabled"
			[attr.required]="requiredText ? true : null" />
		<ng-container *ngIf="autocompleteFormControl.value">
			<fudis-button
				class="fudis-autocomplete__input__icon"
				[size]="'icon-only'"
				[variant]="'tertiary'"
				[icon]="'close'"
				(handleClick)="clearFilter()"
				[label]="clearFilterText"
				[labelHidden]="true">
			</fudis-button>
		</ng-container>

		<ng-container *ngIf="!autocompleteFormControl.value || autocompleteFormControl.value === ''">
			<fudis-icon
				class="fudis-autocomplete__input__icon"
				[icon]="variant === 'search' ? 'search' : 'chevron'"
				[rotate]="variant === 'dropdown' ? 'cw-90' : 'none'"
				[class.fudis-autocomplete__input__icon--disabled]="disabled">
			</fudis-icon>
		</ng-container>
	</div>
	<fudis-guidance [inputLabel]="label" [helpText]="helpText" [for]="_id" [errorMsg]="errorMsg" [control]="control">
	</fudis-guidance>

	<mat-autocomplete class="fudis-autocomplete__option-list" #autocomplete="matAutocomplete">
		<cdk-virtual-scroll-viewport itemSize="1" class="fudis-autocomplete__viewport__{{ size }}">
			<mat-option
				class="fudis-autocomplete__option fudis-autocomplete__viewport__item"
				*cdkVirtualFor="let option of filteredOptions | async"
				[value]="option.viewValue"
				[disabled]="option.disabled">
				{{ option.viewValue }}
			</mat-option>
		</cdk-virtual-scroll-viewport>
	</mat-autocomplete>
</div>
