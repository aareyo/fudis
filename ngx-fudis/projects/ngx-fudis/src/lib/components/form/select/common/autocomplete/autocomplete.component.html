<div class="fudis-select-autocomplete">
  <input
    #inputRef
    type="text"
    aria-required="true"
    class="fudis-form-input fudis-select-autocomplete__input"
    role="combobox"
    [attr.value]="!multiselect && selectedLabel ? selectedLabel : null"
    [attr.aria-controls]="id + '-dropdown'"
    aria-haspopup="listbox"
    (focus)="_inputFocus($event)"
    (blur)="_inputBlur($event)"
    (keyup)="!disabled && !control.disabled && _keyUp($event)"
    (keypress)="!disabled && !control.disabled && _keyPress($event)"
    [attr.id]="id"
    autocomplete="off"
    [attr.aria-autocomplete]="'list'"
    [attr.aria-expanded]="dropdownOpen"
    [attr.aria-disabled]="control.disabled || disabled"
    [attr.placeholder]="placeholder"
    [attr.required]="required ? true : null"
    [attr.aria-labelledby]="id + '-label'"
    [attr.aria-describedby]="id + '_guidance'"
    [attr.aria-invalid]="
      (control.touched && control.invalid) || (control.touched && invalidState) ? true : null
    "
  />
  <fudis-button
    #clearFilterButton
    *ngIf="autocompleteClearButton"
    class="fudis-select-autocomplete__icon"
    [class.fudis-select-autocomplete__icon--hidden]="!inputRef.value"
    [class.fudis-select-autocomplete__icon--disabled]="control.disabled || disabled"
    (click)="_clearAutocompleteFilterText()"
    [size]="'icon-only'"
    [variant]="'tertiary'"
    [icon]="'close'"
    [label]="_translationClearFilterText"
    [labelHidden]="true"
    [disabled]="control.disabled || disabled"
  />
  <fudis-icon
    *ngIf="!autocompleteClearButton"
    class="fudis-select-autocomplete__icon"
    [icon]="'chevron'"
    [rotate]="disabled || control.disabled ? 'cw-90' : dropdownOpen ? 'ccw-90' : 'cw-90'"
  />
  <fudis-icon
    *ngIf="!inputRef.value && autocompleteClearButton"
    class="fudis-select-autocomplete__icon"
    [icon]="'search'"
    [class.fudis-select-autocomplete__icon--disabled]="control.disabled"
  />
</div>
