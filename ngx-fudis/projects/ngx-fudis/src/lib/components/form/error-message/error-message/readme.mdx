import {  Meta, Canvas } from '@storybook/blocks';
import * as ErrorMessageStories from './error-message.stories';

<Meta title="Components/Form/Error Message" />

# Error Message

Fudis form components can implement two types of error messages. Fudis Validator Error Message is an internal error message used by [Fudis Validators](/docs/utilities-validators--documentation).
Also, it is possible to bind custom error message to Fudis form components through content projection. This requires the use of selector `fudis-error-message` when projecting content to another form component. 
Both types of error messages share the same design and are always rendered as a part of Guidance Component.
Read the following documentation on exceptions and on how to use multiple custom error messages at a single form component.

## Examples

<Canvas of={ErrorMessageStories.ErrorMessageExample}></Canvas>

## Usage Guidelines

### Mandatory Properties

The mandatory properties for Error Message are `message` and `visible`. Also, the **NgIf** directive is required so that the Error Message can be passed to Error Summary Component. For the properties, the message parameter can be passed either as a string or as an observable string.
The property visible is a boolean value that is designed to be used with form control state in determining when an error is shown. Notice that property visible does not have an effect on the form's validity. In order for the error message alert icon to be displayed, 
the related form control must be in invalid state and passed to Error Message component in visible property.

````
<fudis-text-input
	[control]="control"
	[label]="'Required text input'">
	<fudis-error-message
		*ngIf="control.invalid && errorExists"
		[message]="'This is a custom error message has been added with content projection'"
		[visible]="control.touched" />
</fudis-text-input>
````
### Using Multiple Error Messages

**Note!** It is recommended to use only one Error Message at a time. When using multiple error messages it is mandatory to pass related form field id as `parentId` and a form field label as `parentLabel` input. 
These inputs are used for linking error message content with related input fields and with [Error Summary](/docs/components-form-error-summary--documentation).

### Error Message with Date Range Component

When it is mandatory to target error message to a single Form Control in Date Range component, use `fudisDateStartError`and `fudisDateEndError` directives for selecting between start and end time inputs.

`````
<fudis-date-range [startDate]="startDate" [endDate]="endDate">
	<ng-template fudisDateStartError>
		<fudis-error-message *ngIf="true" [message]="'Backend threw an error on start date'" [visible]="true" />
	</ng-template>
	<ng-template fudisDateEndError>
		<fudis-error-message *ngIf="true" [message]="'Backend threw an error on end date'" [visible]="true" />
	</ng-template>
</fudis-date-range>
`````


## Accessibility

- Related Form field label and id are linked to error message
- Error Message is correctly passed to [Error Summary](/docs/components-form-error-summary--documentation).

## Related Components

- Guidance Component
- [Error Summary](/docs/components-form-error-summary--documentation)
